[
  {
    "Name": "RateLimit",
    "Priority": 2,
    "Action": {
      "Block": {}
    },
    "Statement": {
      "RateBasedStatement": {
        "Limit": 2000,
        "AggregateKeyType": "IP"
      }
    },
    "VisibilityConfig": {
      "SampledRequestsEnabled": true,
      "CloudWatchMetricsEnabled": true,
      "MetricName": "RateLimit"
    }
  },
  {
    "Name": "BlockSuspiciousUserAgents",
    "Priority": 3,
    "Action": {
      "Block": {}
    },
    "Statement": {
      "ByteMatchStatement": {
        "SearchString": "sqlmap",
        "FieldToMatch": {
          "SingleHeader": {
            "Name": "user-agent"
          }
        },
        "TextTransformation": {
          "Priority": 0,
          "Type": "LOWERCASE"
        },
        "PositionalConstraint": "CONTAINS"
      }
    },
    "VisibilityConfig": {
      "SampledRequestsEnabled": true,
      "CloudWatchMetricsEnabled": true,
      "MetricName": "BlockSuspiciousUserAgents"
    }
  }
]
