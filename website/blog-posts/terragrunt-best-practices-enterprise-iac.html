<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terragrunt Best Practices: Enterprise Infrastructure as Code at Scale - Robert Consulting</title>
    <meta name="description" content="Master Terragrunt for enterprise-scale Infrastructure as Code. Learn DRY principles, environment management, remote state configuration, and advanced patterns for large organizations.">
    <meta name="keywords" content="Terragrunt, Infrastructure as Code, Terraform, DRY principles, enterprise IaC, remote state, environment management, best practices">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://robertconsulting.net/blog-posts/terragrunt-best-practices-enterprise-iac.html">
    <meta property="og:title" content="Terragrunt Best Practices: Enterprise Infrastructure as Code at Scale">
    <meta property="og:description" content="Master Terragrunt for enterprise-scale Infrastructure as Code. Learn DRY principles, environment management, remote state configuration, and advanced patterns for large organizations.">
    <meta property="og:site_name" content="Robert Consulting">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://robertconsulting.net/blog-posts/terragrunt-best-practices-enterprise-iac.html">
    <meta property="twitter:title" content="Terragrunt Best Practices: Enterprise Infrastructure as Code at Scale">
    <meta property="twitter:description" content="Master Terragrunt for enterprise-scale Infrastructure as Code. Learn DRY principles, environment management, remote state configuration, and advanced patterns for large organizations.">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "headline": "Terragrunt Best Practices: Enterprise Infrastructure as Code at Scale",
      "description": "Master Terragrunt for enterprise-scale Infrastructure as Code. Learn DRY principles, environment management, remote state configuration, and advanced patterns for large organizations.",
      "author": {
        "@type": "Person",
        "name": "Robert Consulting"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Robert Consulting",
        "logo": {
          "@type": "ImageObject",
          "url": "https://robertconsulting.net/favicon.svg"
        }
      },
      "datePublished": "2025-10-21",
      "dateModified": "2025-10-21",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://robertconsulting.net/blog-posts/terragrunt-best-practices-enterprise-iac.html"
      },
      "about": [
        {
          "@type": "Thing",
          "name": "Terragrunt"
        },
        {
          "@type": "Thing",
          "name": "Infrastructure as Code"
        },
        {
          "@type": "Thing",
          "name": "Terraform"
        }
      ],
      "keywords": "Terragrunt, Infrastructure as Code, Terraform, DRY principles, enterprise IaC, remote state, environment management, best practices"
    }
    </script>
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://robertconsulting.net/blog-posts/terragrunt-best-practices-enterprise-iac.html">
    
    <link rel="stylesheet" href="../css/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Blog Post Styles -->
    <style>
        .blog-post-hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 80px 0;
            text-align: center;
        }
        
        .blog-post-hero h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            font-weight: 700;
            line-height: 1.2;
        }
        
        .blog-post-meta {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .blog-post-meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .blog-post-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 60px 20px;
        }
        
        .blog-post-content h2 {
            font-size: 1.8rem;
            margin: 40px 0 20px 0;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .blog-post-content h3 {
            font-size: 1.4rem;
            margin: 30px 0 15px 0;
            color: #444;
        }
        
        .blog-post-content p {
            font-size: 1.1rem;
            line-height: 1.7;
            margin-bottom: 20px;
            color: #555;
        }
        
        .blog-post-content ul, .blog-post-content ol {
            margin: 20px 0;
            padding-left: 30px;
        }
        
        .blog-post-content li {
            font-size: 1.1rem;
            line-height: 1.7;
            margin-bottom: 10px;
            color: #555;
        }
        
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
        }
        
        .code-block pre {
            margin: 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #333;
        }
        
        .highlight-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin: 30px 0;
        }
        
        .highlight-box h3 {
            color: white;
            margin-top: 0;
        }
        
        .blog-post-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 40px 0;
            padding: 20px 0;
            border-top: 1px solid #e9ecef;
            border-bottom: 1px solid #e9ecef;
        }
        
        .blog-tag {
            background: #667eea;
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .blog-post-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #e9ecef;
        }
        
        .nav-link {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            padding: 10px 20px;
            border: 2px solid #667eea;
            border-radius: 25px;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            background: #667eea;
            color: white;
        }
        
        @media (max-width: 768px) {
            .blog-post-hero h1 {
                font-size: 2rem;
            }
            
            .blog-post-meta {
                flex-direction: column;
                gap: 15px;
            }
            
            .blog-post-navigation {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body class="dark-theme">
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>Robert Consulting</h2>
                <span class="nav-tagline">DevSecOps & Cloud Engineering</span>
            </div>
            <ul class="nav-menu" id="nav-menu">
                <li class="nav-item">
                    <a href="../index.html#home" class="nav-link">Home</a>
                </li>
                <li class="nav-item">
                    <a href="../index.html#services" class="nav-link">Services</a>
                </li>
                <li class="nav-item">
                    <a href="../index.html#about" class="nav-link">About</a>
                </li>
                <li class="nav-item">
                    <a href="../learning.html" class="nav-link">Learning</a>
                </li>
                <li class="nav-item">
                    <a href="../blog.html" class="nav-link active">Blog</a>
                </li>
                <li class="nav-item">
                    <a href="../dashboard.html" class="nav-link">Dashboard</a>
                </li>
                <li class="nav-item">
                    <a href="../best-practices.html" class="nav-link">Best Practices</a>
                </li>
                <li class="nav-item">
                    <a href="../index.html#experience" class="nav-link">Experience</a>
                </li>
                <li class="nav-item">
                    <a href="../index.html#contact" class="nav-link">Contact</a>
                </li>
            </ul>
            <button type="button" class="hamburger" id="hamburger" aria-expanded="false" aria-controls="nav-menu" aria-label="Menu">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
        </div>
    </nav>

    <!-- Blog Post Hero -->
    <section class="blog-post-hero">
        <div class="container">
            <h1>üèóÔ∏è Terragrunt Best Practices: Enterprise Infrastructure as Code at Scale</h1>
            <div class="blog-post-meta">
                <div class="blog-post-meta-item">
                    <span>üìÖ</span>
                    <span>October 21, 2025</span>
                </div>
                <div class="blog-post-meta-item">
                    <span>‚è±Ô∏è</span>
                    <span>13 min read</span>
                </div>
                <div class="blog-post-meta-item">
                    <span>üè∑Ô∏è</span>
                    <span>TERRAFORM</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Blog Post Content -->
    <article class="blog-post-content">
        <p>Terragrunt is the missing piece for enterprise-scale Terraform. When I implemented Terragrunt for a client managing 200+ environments across 15 AWS accounts, we reduced code duplication by 80%, standardized deployments across all environments, and cut deployment time from hours to minutes. Here's how to master Terragrunt for large-scale Infrastructure as Code with DRY principles, environment management, and advanced patterns.</p>

        <h2>What is Terragrunt and Why Use It?</h2>
        
        <p>Terragrunt is a thin wrapper around Terraform that provides:</p>
        
        <ul>
            <li><strong>DRY (Don't Repeat Yourself):</strong> Eliminate code duplication across environments</li>
            <li><strong>Remote State Management:</strong> Automatic backend configuration</li>
            <li><strong>Dependency Management:</strong> Define and manage module dependencies</li>
            <li><strong>Environment Management:</strong> Consistent configuration across environments</li>
            <li><strong>Hooks:</strong> Execute commands before and after Terraform operations</li>
        </ul>

        <div class="highlight-box">
            <h3>üí° Terragrunt Benefits</h3>
            <p><strong>Code Reduction:</strong> 80% less duplicated code across environments<br>
            <strong>Consistency:</strong> Standardized configurations and deployments<br>
            <strong>Scalability:</strong> Manage hundreds of environments efficiently<br>
            <strong>Maintainability:</strong> Single source of truth for configurations<br>
            <strong>Automation:</strong> Built-in hooks and dependency management</p>
        </div>

        <h2>Terragrunt Project Structure</h2>
        
        <p>Organize your Terragrunt project for maximum maintainability:</p>

        <div class="code-block">
            <pre>infrastructure/
‚îú‚îÄ‚îÄ terragrunt.hcl                    # Root configuration
‚îú‚îÄ‚îÄ environments/
‚îÇ   ‚îú‚îÄ‚îÄ dev/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ terragrunt.hcl           # Dev environment config
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ us-east-1/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ vpc/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ terragrunt.hcl
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ecs/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ terragrunt.hcl
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ rds/
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ terragrunt.hcl
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ us-west-2/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ vpc/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ terragrunt.hcl
‚îÇ   ‚îú‚îÄ‚îÄ staging/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ terragrunt.hcl
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ us-east-1/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ vpc/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ecs/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ rds/
‚îÇ   ‚îî‚îÄ‚îÄ prod/
‚îÇ       ‚îú‚îÄ‚îÄ terragrunt.hcl
‚îÇ       ‚îî‚îÄ‚îÄ us-east-1/
‚îÇ           ‚îú‚îÄ‚îÄ vpc/
‚îÇ           ‚îú‚îÄ‚îÄ ecs/
‚îÇ           ‚îî‚îÄ‚îÄ rds/
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ vpc/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.tf
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ variables.tf
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf
‚îÇ   ‚îú‚îÄ‚îÄ ecs/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.tf
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ variables.tf
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf
‚îÇ   ‚îî‚îÄ‚îÄ rds/
‚îÇ       ‚îú‚îÄ‚îÄ main.tf
‚îÇ       ‚îú‚îÄ‚îÄ variables.tf
‚îÇ       ‚îî‚îÄ‚îÄ outputs.tf
‚îî‚îÄ‚îÄ scripts/
    ‚îú‚îÄ‚îÄ deploy.sh
    ‚îî‚îÄ‚îÄ destroy.sh</pre>
        </div>

        <h2>Root Configuration (terragrunt.hcl)</h2>
        
        <p>Set up the root configuration with common settings:</p>

        <div class="code-block">
            <pre># Root terragrunt.hcl
# Configure Terragrunt to automatically store tfstate files in an S3 bucket
remote_state {
  backend = "s3"
  config = {
    bucket         = "my-company-terraform-state"
    key            = "${path_relative_to_include()}/terraform.tfstate"
    region         = "us-east-1"
    encrypt        = true
    dynamodb_table = "terraform-locks"
  }
  generate = {
    path      = "backend.tf"
    if_exists = "overwrite_terragrunt"
  }
}

# Configure root level variables that all resources can inherit
locals {
  # Automatically load account-level variables
  account_vars = read_terragrunt_config(find_in_parent_folders("account.hcl"))
  region_vars  = read_terragrunt_config(find_in_parent_folders("region.hcl"))
  
  # Extract the variables we need
  aws_region   = local.region_vars.locals.aws_region
  account_id   = local.account_vars.locals.account_id
  account_name = local.account_vars.locals.account_name
}

# Generate provider configuration
generate "provider" {
  path      = "provider.tf"
  if_exists = "overwrite_terragrunt"
  contents  = <<EOF
terraform {
  required_version = ">= 1.0"
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~> 5.0"
    }
  }
}

provider "aws" {
  region = "${local.aws_region}"
  
  default_tags {
    tags = {
      Environment   = "${local.account_name}"
      ManagedBy     = "terragrunt"
      Project       = "my-project"
      AccountId     = "${local.account_id}"
    }
  }
}
EOF
}

# Configure how Terragrunt will interact with Terraform
terraform {
  source = "${get_parent_terragrunt_dir()}/../modules//${path_relative_to_include()}"
}

# Configure input variables
inputs = {
  aws_region   = local.aws_region
  account_id   = local.account_id
  account_name = local.account_name
}</pre>
        </div>

        <h2>Environment-Specific Configuration</h2>
        
        <p>Create environment-specific configurations:</p>

        <div class="code-block">
            <pre># environments/dev/terragrunt.hcl
# Include all settings from the root terragrunt.hcl
include "root" {
  path = find_in_parent_folders()
}

# Configure Terragrunt to use the common remote state configuration
remote_state {
  backend = "s3"
  config = {
    bucket         = "my-company-terraform-state"
    key            = "dev/${path_relative_to_include()}/terraform.tfstate"
    region         = "us-east-1"
    encrypt        = true
    dynamodb_table = "terraform-locks"
  }
  generate = {
    path      = "backend.tf"
    if_exists = "overwrite_terragrunt"
  }
}

# Environment-specific inputs
inputs = {
  environment = "dev"
  instance_type = "t3.micro"
  min_size = 1
  max_size = 3
  desired_capacity = 2
  
  # Environment-specific tags
  tags = {
    Environment = "development"
    CostCenter  = "engineering"
    Owner       = "dev-team"
  }
}

# Pre and post hooks
terraform {
  before_hook "before_hook" {
    commands     = ["apply", "plan"]
    execute      = ["echo", "Running Terraform in DEV environment"]
  }
  
  after_hook "after_hook" {
    commands     = ["apply"]
    execute      = ["echo", "Terraform apply completed in DEV environment"]
    run_on_error = true
  }
}</pre>
        </div>

        <h2>Account and Region Configuration</h2>
        
        <p>Use separate configuration files for account and region settings:</p>

        <div class="code-block">
            <pre># environments/dev/account.hcl
locals {
  account_id   = "123456789012"
  account_name = "dev"
  domain_name  = "dev.mycompany.com"
  
  # Account-specific settings
  allowed_cidr_blocks = [
    "10.0.0.0/8",
    "172.16.0.0/12",
    "192.168.0.0/16"
  ]
  
  # Backup settings
  backup_retention_days = 7
  backup_window = "03:00-04:00"
  
  # Monitoring settings
  enable_detailed_monitoring = true
  log_retention_days = 30
}

# environments/dev/us-east-1/region.hcl
locals {
  aws_region = "us-east-1"
  
  # Region-specific availability zones
  availability_zones = [
    "us-east-1a",
    "us-east-1b",
    "us-east-1c"
  ]
  
  # Region-specific CIDR blocks
  vpc_cidr = "10.0.0.0/16"
  
  # Region-specific settings
  enable_nat_gateway = true
  enable_vpn_gateway = false
  
  # Performance settings
  enable_enhanced_networking = true
  enable_placement_groups = true
}</pre>
        </div>

        <h2>Module Configuration</h2>
        
        <p>Configure individual modules with dependencies:</p>

        <div class="code-block">
            <pre># environments/dev/us-east-1/vpc/terragrunt.hcl
include "root" {
  path = find_in_parent_folders()
}

# Configure the module source
terraform {
  source = "${get_parent_terragrunt_dir()}/../../../modules//vpc"
}

# Define dependencies
dependencies {
  paths = []
}

# Module-specific inputs
inputs = {
  name = "dev-vpc"
  cidr = "10.0.0.0/16"
  
  availability_zones = [
    "us-east-1a",
    "us-east-1b",
    "us-east-1c"
  ]
  
  public_subnet_cidrs = [
    "10.0.1.0/24",
    "10.0.2.0/24",
    "10.0.3.0/24"
  ]
  
  private_subnet_cidrs = [
    "10.0.11.0/24",
    "10.0.12.0/24",
    "10.0.13.0/24"
  ]
  
  enable_nat_gateway = true
  enable_vpn_gateway = false
  
  tags = {
    Name        = "dev-vpc"
    Environment = "dev"
    Project     = "my-project"
  }
}

# environments/dev/us-east-1/ecs/terragrunt.hcl
include "root" {
  path = find_in_parent_folders()
}

terraform {
  source = "${get_parent_terragrunt_dir()}/../../../modules//ecs"
}

# Define dependencies on VPC
dependencies {
  paths = ["../vpc"]
}

# Get outputs from VPC module
dependency "vpc" {
  config_path = "../vpc"
  
  mock_outputs = {
    vpc_id = "vpc-12345678"
    private_subnet_ids = ["subnet-12345678", "subnet-87654321"]
    public_subnet_ids = ["subnet-11111111", "subnet-22222222"]
  }
  
  mock_outputs_allowed_terraform_commands = ["validate", "plan"]
}

inputs = {
  name = "dev-ecs"
  
  # Use outputs from VPC dependency
  vpc_id = dependency.vpc.outputs.vpc_id
  private_subnet_ids = dependency.vpc.outputs.private_subnet_ids
  
  # ECS-specific configuration
  cluster_name = "dev-cluster"
  instance_type = "t3.medium"
  min_size = 1
  max_size = 5
  desired_capacity = 2
  
  # Application configuration
  app_name = "my-app"
  app_port = 8080
  app_image = "my-app:latest"
  
  tags = {
    Name        = "dev-ecs"
    Environment = "dev"
    Project     = "my-project"
  }
}</pre>
        </div>

        <h2>Advanced Terragrunt Patterns</h2>
        
        <p>Implement advanced patterns for complex scenarios:</p>

        <div class="code-block">
            <pre># environments/prod/terragrunt.hcl
include "root" {
  path = find_in_parent_folders()
}

# Production-specific configuration
inputs = {
  environment = "prod"
  instance_type = "t3.large"
  min_size = 3
  max_size = 10
  desired_capacity = 5
  
  # Production-specific settings
  enable_deletion_protection = true
  enable_termination_protection = true
  enable_encryption = true
  
  # Backup settings
  backup_retention_days = 30
  backup_window = "02:00-03:00"
  maintenance_window = "sun:03:00-sun:04:00"
  
  # Monitoring settings
  enable_detailed_monitoring = true
  log_retention_days = 90
  
  # Security settings
  enable_cloudtrail = true
  enable_config = true
  enable_guardduty = true
  
  tags = {
    Environment = "production"
    CostCenter  = "operations"
    Owner       = "ops-team"
    Backup      = "required"
    Compliance  = "required"
  }
}

# Production-specific hooks
terraform {
  before_hook "validate" {
    commands = ["apply", "plan"]
    execute  = ["terragrunt", "run-all", "validate", "--terragrunt-non-interactive"]
  }
  
  before_hook "security_scan" {
    commands = ["apply", "plan"]
    execute  = ["checkov", "-f", ".", "--framework", "terraform"]
  }
  
  after_hook "notify" {
    commands = ["apply"]
    execute  = ["python3", "../../../scripts/notify.py", "terraform-apply-completed"]
  }
  
  error_hook "error_notification" {
    commands  = ["apply", "plan"]
    execute   = ["python3", "../../../scripts/notify.py", "terraform-error"]
    on_errors = [
      ".*",
    ]
  }
}</pre>
        </div>

        <h2>Dependency Management</h2>
        
        <p>Handle complex dependencies between modules:</p>

        <div class="code-block">
            <pre># environments/dev/us-east-1/rds/terragrunt.hcl
include "root" {
  path = find_in_parent_folders()
}

terraform {
  source = "${get_parent_terragrunt_dir()}/../../../modules//rds"
}

# Multiple dependencies
dependencies {
  paths = ["../vpc", "../ecs"]
}

# VPC dependency
dependency "vpc" {
  config_path = "../vpc"
  
  mock_outputs = {
    vpc_id = "vpc-12345678"
    private_subnet_ids = ["subnet-12345678", "subnet-87654321"]
    database_subnet_group_name = "dev-db-subnet-group"
  }
  
  mock_outputs_allowed_terraform_commands = ["validate", "plan"]
}

# ECS dependency for security group
dependency "ecs" {
  config_path = "../ecs"
  
  mock_outputs = {
    security_group_id = "sg-12345678"
  }
  
  mock_outputs_allowed_terraform_commands = ["validate", "plan"]
}

inputs = {
  name = "dev-rds"
  
  # Database configuration
  engine = "postgres"
  engine_version = "13.7"
  instance_class = "db.t3.micro"
  allocated_storage = 20
  max_allocated_storage = 100
  
  # Use VPC outputs
  vpc_id = dependency.vpc.outputs.vpc_id
  subnet_ids = dependency.vpc.outputs.private_subnet_ids
  db_subnet_group_name = dependency.vpc.outputs.database_subnet_group_name
  
  # Security configuration
  vpc_security_group_ids = [dependency.ecs.outputs.security_group_id]
  
  # Backup configuration
  backup_retention_period = 7
  backup_window = "03:00-04:00"
  maintenance_window = "sun:04:00-sun:05:00"
  
  # Encryption
  storage_encrypted = true
  
  tags = {
    Name        = "dev-rds"
    Environment = "dev"
    Project     = "my-project"
  }
}</pre>
        </div>

        <h2>Terragrunt Hooks and Automation</h2>
        
        <p>Use hooks for automation and validation:</p>

        <div class="code-block">
            <pre># Global hooks in root terragrunt.hcl
terraform {
  # Pre-apply hooks
  before_hook "validate" {
    commands = ["apply", "plan"]
    execute  = ["terraform", "validate"]
  }
  
  before_hook "format_check" {
    commands = ["apply", "plan"]
    execute  = ["terraform", "fmt", "-check"]
  }
  
  before_hook "security_scan" {
    commands = ["apply", "plan"]
    execute  = ["checkov", "-f", ".", "--framework", "terraform", "--quiet"]
  }
  
  # Post-apply hooks
  after_hook "output_summary" {
    commands = ["apply"]
    execute  = ["echo", "Terraform apply completed successfully"]
  }
  
  # Error hooks
  error_hook "error_notification" {
    commands  = ["apply", "plan", "destroy"]
    execute   = ["python3", "scripts/notify_error.py"]
    on_errors = [
      ".*",
    ]
  }
}

# Custom hook script
# scripts/notify_error.py
#!/usr/bin/env python3
import json
import sys
import os
from datetime import datetime

def send_notification(error_message):
    # Send notification to Slack, email, etc.
    print(f"Error notification: {error_message}")
    
    # Log to file
    with open("terragrunt-errors.log", "a") as f:
        f.write(f"{datetime.now()}: {error_message}\n")

if __name__ == "__main__":
    error_message = " ".join(sys.argv[1:])
    send_notification(error_message)</pre>
        </div>

        <h2>Terragrunt Commands and Workflows</h2>
        
        <p>Common Terragrunt commands and deployment workflows:</p>

        <div class="code-block">
            <pre>#!/bin/bash
# scripts/deploy.sh - Deployment script

set -e

ENVIRONMENT=${1:-dev}
REGION=${2:-us-east-1}
ACTION=${3:-plan}

echo "Deploying to $ENVIRONMENT in $REGION with action: $ACTION"

# Change to the environment directory
cd "environments/$ENVIRONMENT/$REGION"

# Run Terragrunt commands
case $ACTION in
  "plan")
    echo "Running terraform plan..."
    terragrunt run-all plan --terragrunt-non-interactive
    ;;
  "apply")
    echo "Running terraform apply..."
    terragrunt run-all apply --terragrunt-non-interactive
    ;;
  "destroy")
    echo "Running terraform destroy..."
    terragrunt run-all destroy --terragrunt-non-interactive
    ;;
  "validate")
    echo "Running terraform validate..."
    terragrunt run-all validate --terragrunt-non-interactive
    ;;
  "format")
    echo "Running terraform fmt..."
    terragrunt run-all fmt --terragrunt-non-interactive
    ;;
  *)
    echo "Usage: $0 <environment> <region> <action>"
    echo "Actions: plan, apply, destroy, validate, format"
    exit 1
    ;;
esac

echo "Deployment completed successfully!"

# Example usage:
# ./scripts/deploy.sh dev us-east-1 plan
# ./scripts/deploy.sh prod us-east-1 apply
# ./scripts/deploy.sh staging us-west-2 destroy</pre>
        </div>

        <h2>CI/CD Integration</h2>
        
        <p>Integrate Terragrunt with CI/CD pipelines:</p>

        <div class="code-block">
            <pre># .github/workflows/terragrunt-deploy.yml
name: 'Terragrunt Deploy'

on:
  push:
    branches: [ main, develop ]
    paths:
      - 'infrastructure/**'
  pull_request:
    branches: [ main ]
    paths:
      - 'infrastructure/**'

env:
  TF_VERSION: '1.6.0'
  TERRAGRUNT_VERSION: '0.50.0'

jobs:
  terragrunt-plan:
    name: 'Terragrunt Plan'
    runs-on: ubuntu-latest
    
    strategy:
      matrix:
        environment: [dev, staging]
        region: [us-east-1, us-west-2]
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Setup Terraform
      uses: hashicorp/setup-terraform@v3
      with:
        terraform_version: ${{ env.TF_VERSION }}
    
    - name: Setup Terragrunt
      run: |
        wget https://github.com/gruntwork-io/terragrunt/releases/download/v${{ env.TERRAGRUNT_VERSION }}/terragrunt_linux_amd64
        chmod +x terragrunt_linux_amd64
        sudo mv terragrunt_linux_amd64 /usr/local/bin/terragrunt
    
    - name: Terragrunt Init
      run: |
        cd infrastructure/environments/${{ matrix.environment }}/${{ matrix.region }}
        terragrunt run-all init --terragrunt-non-interactive
    
    - name: Terragrunt Validate
      run: |
        cd infrastructure/environments/${{ matrix.environment }}/${{ matrix.region }}
        terragrunt run-all validate --terragrunt-non-interactive
    
    - name: Terragrunt Plan
      run: |
        cd infrastructure/environments/${{ matrix.environment }}/${{ matrix.region }}
        terragrunt run-all plan --terragrunt-non-interactive
      env:
        AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
        AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
    
    - name: Comment Plan Results
      uses: actions/github-script@v7
      with:
        script: |
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: `## Terragrunt Plan - ${{ matrix.environment }}/${{ matrix.region }}
            
            ‚úÖ Plan completed successfully
            üîç Review the changes before applying`
          });

  terragrunt-apply:
    name: 'Terragrunt Apply'
    runs-on: ubuntu-latest
    needs: terragrunt-plan
    if: github.ref == 'refs/heads/main'
    
    environment: ${{ matrix.environment }}
    
    strategy:
      matrix:
        environment: [dev, staging]
        region: [us-east-1, us-west-2]
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Setup Terraform
      uses: hashicorp/setup-terraform@v3
      with:
        terraform_version: ${{ env.TF_VERSION }}
    
    - name: Setup Terragrunt
      run: |
        wget https://github.com/gruntwork-io/terragrunt/releases/download/v${{ env.TERRAGRUNT_VERSION }}/terragrunt_linux_amd64
        chmod +x terragrunt_linux_amd64
        sudo mv terragrunt_linux_amd64 /usr/local/bin/terragrunt
    
    - name: Terragrunt Apply
      run: |
        cd infrastructure/environments/${{ matrix.environment }}/${{ matrix.region }}
        terragrunt run-all apply --terragrunt-non-interactive
      env:
        AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
        AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
    
    - name: Update Deployment Status
      uses: actions/github-script@v7
      with:
        script: |
          github.rest.repos.createCommitStatus({
            owner: context.repo.owner,
            repo: context.repo.repo,
            sha: context.sha,
            state: 'success',
            target_url: `${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`,
            description: 'Terragrunt apply completed successfully',
            context: `terragrunt-apply-${{ matrix.environment }}-${{ matrix.region }}`
          });</pre>
        </div>

        <h2>Best Practices Summary</h2>
        
        <div class="highlight-box">
            <h3>üìã Terragrunt Best Practices</h3>
            <p><strong>Structure:</strong> Organize by environment, region, and module<br>
            <strong>DRY Principle:</strong> Use includes and locals to eliminate duplication<br>
            <strong>Dependencies:</strong> Define clear module dependencies<br>
            <strong>Hooks:</strong> Use hooks for validation and automation<br>
            <strong>State Management:</strong> Centralized remote state configuration<br>
            <strong>Testing:</strong> Use mock outputs for dependency testing</p>
        </div>

        <h2>Implementation Results</h2>
        
        <p>After implementing Terragrunt best practices, we achieved:</p>

        <ul>
            <li><strong>Code Reduction:</strong> 80% less duplicated code across environments</li>
            <li><strong>Deployment Time:</strong> From 4 hours to 30 minutes</li>
            <li><strong>Consistency:</strong> 100% standardized configurations</li>
            <li><strong>Maintainability:</strong> Single source of truth for all environments</li>
            <li><strong>Scalability:</strong> Easily manage 200+ environments</li>
        </ul>

        <h2>Getting Started with Terragrunt</h2>
        
        <ol>
            <li><strong>Install Terragrunt</strong> - Download and install the latest version</li>
            <li><strong>Design your structure</strong> - Plan your environment and module organization</li>
            <li><strong>Create root configuration</strong> - Set up common settings and remote state</li>
            <li><strong>Configure environments</strong> - Create environment-specific configurations</li>
            <li><strong>Define modules</strong> - Create reusable Terraform modules</li>
            <li><strong>Set up dependencies</strong> - Define module dependencies</li>
            <li><strong>Add hooks</strong> - Implement validation and automation hooks</li>
            <li><strong>Test thoroughly</strong> - Validate configurations before production use</li>
        </ol>

        <p>Terragrunt transforms Terraform from a tool for individual environments into a powerful platform for enterprise-scale Infrastructure as Code. By following these best practices, you'll achieve DRY principles, consistent deployments, and scalable infrastructure management across your entire organization.</p>

        <div class="blog-post-tags">
            <span class="blog-tag">Terragrunt</span>
            <span class="blog-tag">Infrastructure as Code</span>
            <span class="blog-tag">Terraform</span>
            <span class="blog-tag">DRY Principles</span>
            <span class="blog-tag">Enterprise IaC</span>
            <span class="blog-tag">Best Practices</span>
        </div>

        <div class="blog-post-navigation">
            <a href="../blog.html" class="nav-link">‚Üê Back to Blog</a>
            <a href="../index.html#contact" class="nav-link">Get Terragrunt Implementation Help ‚Üí</a>
        </div>
    </article>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Robert Consulting</h3>
                    <p>DevSecOps and cloud engineering solutions for organizations. Specializing in AWS, Terraform, CI/CD automation, and compliance frameworks.</p>
                </div>
                <div class="footer-section">
                    <h4>Services</h4>
                    <ul>
                        <li><a href="../index.html#services">Cloud Infrastructure</a></li>
                        <li><a href="../index.html#services">CI/CD Automation</a></li>
                        <li><a href="../index.html#services">Security & Compliance</a></li>
                        <li><a href="../index.html#services">Database DevOps</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="../learning.html">Learning Journey</a></li>
                        <li><a href="../blog.html">Blog</a></li>
                        <li><a href="../status.html">Status Page</a></li>
                        <li><a href="../monitoring.html">Monitoring</a></li>
                        <li><a href="../best-practices.html">Best Practices</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact Information</h4>
                    <p>info@robertconsulting.net</p>
                    <p>(434) 227-8323</p>
                    <p><a href="https://robertconsulting.net" target="_blank" rel="noopener noreferrer">robertconsulting.net</a></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Robert Consulting. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script defer src="../js/navigation.js"></script>
</body>
</html>
