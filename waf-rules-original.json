[
  {
    "Name": "AllowSpecificIPs",
    "Priority": 1,
    "Action": {
      "Allow": {}
    },
    "Statement": {
      "IPSetReferenceStatement": {
        "ARN": "arn:aws:wafv2:us-east-1:228480945348:global/ipset/staging-allowed-ips/b8c787ba-50b4-4aaa-80f1-c1c6ee0a9a87"
      }
    },
    "VisibilityConfig": {
      "SampledRequestsEnabled": true,
      "CloudWatchMetricsEnabled": true,
      "MetricName": "AllowSpecificIPs"
    }
  },
  {
    "Name": "RateLimit",
    "Priority": 2,
    "Action": {
      "Block": {}
    },
    "Statement": {
      "RateBasedStatement": {
        "Limit": 2000,
        "AggregateKeyType": "IP"
      }
    },
    "VisibilityConfig": {
      "SampledRequestsEnabled": true,
      "CloudWatchMetricsEnabled": true,
      "MetricName": "RateLimit"
    }
  },
  {
    "Name": "BlockSuspiciousUserAgents",
    "Priority": 3,
    "Action": {
      "Block": {}
    },
    "Statement": {
      "ByteMatchStatement": {
        "SearchString": "sqlmap",
        "FieldToMatch": {
          "SingleHeader": {
            "Name": "user-agent"
          }
        },
        "TextTransformation": {
          "Priority": 0,
          "Type": "LOWERCASE"
        },
        "PositionalConstraint": "CONTAINS"
      }
    },
    "VisibilityConfig": {
      "SampledRequestsEnabled": true,
      "CloudWatchMetricsEnabled": true,
      "MetricName": "BlockSuspiciousUserAgents"
    }
  }
]
